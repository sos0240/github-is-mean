# Research Log: Brazil CVM
**Generated**: 2026-02-24T15:39:00Z
**Status**: Complete

---

## 1. VERSION INFORMATION

| Component | Current (in requirements.txt) | Latest Available | Action Required |
|-----------|-------------------------------|------------------|-----------------|
| pycvm | >=0.4 | 0.4.1 | OK -- but see notes below |

---

# =====================================================================
# PART A: UNOFFICIAL COMMUNITY WRAPPER -- pycvm
# =====================================================================

## A1. Registry Data

**Source**: https://pypi.org/pypi/pycvm/json (fetched 2026-02-24)
```
name: pycvm
version: 0.4.1
summary: Python library for processing data from CVM
```

Note: The actual PyPI package is called `pycvm` but the library imports as `cvm`.

## A2. Verbatim Code

**Source**: https://github.com/glourencoffee/pycvm/blob/main/README.md (fetched 2026-02-24)
```python
# COPIED VERBATIM -- pycvm uses file-based access, NOT web API
import cvm

with cvm.FCAFile('caminho/para/fca.zip') as file:
    for fca in file:
        print(fca.company_name, 'entregou o documento FCA em', fca.receipt_date)

with cvm.DFPITRFile('caminho/para/dfp_ou_itr.zip') as file:
    for dfpitr in file:
        print(dfpitr.company_name, 'entregou o documento', dfpitr.type.name, 'em', dfpitr.receipt_date)
```

**IMPORTANT**: pycvm uses FILE-BASED access -- you download ZIP files from CVM and
parse them locally. It does NOT make HTTP API calls. Our wrapper imports `pycvm`
but then downloads CSVs directly from `dados.cvm.gov.br` without using the library.

## A3. Verbatim README Note

**Source**: https://github.com/glourencoffee/pycvm/blob/main/README.md
```
# COPIED VERBATIM (Portuguese)
Note que a biblioteca nao foi testada por completo e sua API ainda esta instavel.
```
Translation: "Note that the library has not been fully tested and its API is still unstable."

## A4. Supported Document Types

**Source**: README (verbatim)
```
# COPIED VERBATIM
O Portal de Dados da CVM disponibiliza os seguintes tipos de documentos:
- Formulario Cadastral (FCA)
- Demonstracoes Financeiras Padronizadas (DFP)
- Informacoes Trimestrais (ITR)
- Formulario de Referencia (FRE)
- Informes Periodicos e Eventuais (IPE)
- Informacao Cadastral (CAD)

Atualmente, esta biblioteca suporta os documentos FCA, FRE (parcial), DFP e ITR.
```

## A5. Audit of Our Wrapper

`_fetch_via_pycvm()` in `br_cvm_wrapper.py` has `import pycvm` at top but then
downloads CSVs directly -- it does NOT use pycvm's file-based API. This means
pycvm is a dependency but not actually utilized for data fetching.

---

# =====================================================================
# PART B: GOVERNMENT API -- CVM Open Data Portal
# =====================================================================

## B1. Company List Endpoint

**Endpoint**: `https://dados.cvm.gov.br/api/v1/cia_aberta`
**Params**: `$top=500&$format=json` (OData format)
**No key required**

## B2. Financial Statement CSV Datasets

**Source**: https://dados.cvm.gov.br/dados/CIA_ABERTA/DOC/DFP/DADOS/
```
# URL pattern for annual statements (DFP)
https://dados.cvm.gov.br/dados/CIA_ABERTA/DOC/DFP/DADOS/dfp_cia_aberta_{year}.csv
```

CSV format: semicolon-separated, latin-1 encoding, columns include:
- `CD_CVM`: CVM company code
- `DENOM_CIA`: company name
- `CD_CONTA`: account code (hierarchical, e.g., "3.01" = Revenue)
- `DS_CONTA`: account description

## B3. Canonical Field Coverage (via _CVM_ACCOUNT_MAP in canonical_translator.py)

```
# VERBATIM from canonical_translator.py
_CVM_ACCOUNT_MAP: dict[str, str] = {
    # DRE (Income statement)
    "3.01": "revenue",
    "3.02": "cost_of_revenue",
    "3.03": "gross_profit",
    ...
}
```

---

# =====================================================================
# PART C: SUMMARY
# =====================================================================

| Mode | Component | Status |
|------|-----------|--------|
| Unofficial | pycvm 0.4.1 | IMPORTED BUT NOT USED -- file-based API, not web |
| Government | dados.cvm.gov.br REST + CSV | WORKING |

### Required Fixes
1. **MINOR**: Either properly use pycvm's DFPITRFile API or remove the import
2. **NONE critical** -- government API endpoints and CSV parsing work correctly

---


# =====================================================================
# PART D: OHLCV & MACRO COVERAGE (added 2026-02-24)
# =====================================================================

## D1. OHLCV Price Data

**Primary**: yfinance 1.2.0 (global, no API key, 21.7k stars)
**Research log**: `.roo/research/ohlcv-yfinance-2026-02-24.md`

```python
# VERBATIM from yfinance source -- fetch Brazil OHLCV
import yfinance as yf
df = yf.download(
    "PETR4.SA",     # Brazil ticker with ".SA" suffix
    period="5y",
    auto_adjust=False,      # raw/unadjusted OHLCV (PIT-safe)
    progress=False,
)
# Returns: DataFrame(Open, High, Low, Close, Adj Close, Volume)
```

**Ticker suffix for Brazil**: `.SA`
**Example**: `PETR4.SA`
**Notes**: python-bcb 0.3.3 for higher-freq macro. yfinance for OHLCV.

## D2. Macro Economic Data

**Primary**: wbgapi 1.0.13 (World Bank, 200+ countries, no API key)
**Research log**: `.roo/research/macro-wbgapi-2026-02-24.md`

```python
# VERBATIM from wbgapi source -- fetch Brazil macro indicators
import wbgapi as wb
df = wb.data.DataFrame(
    ["NY.GDP.MKTP.KD.ZG", "FP.CPI.TOTL.ZG", "SL.UEM.TOTL.ZS"],
    economy="BRA",    # Brazil World Bank code
    mrv=10,                 # most recent 10 years
    numericTimeKeys=True,
)
# Returns: DataFrame with GDP growth, inflation, unemployment
```

**World Bank code for Brazil**: `BRA`

**END OF RESEARCH LOG**
