# Research Log: EU ESEF
**Generated**: 2026-02-24T15:38:00Z
**Status**: Complete

---

## 1. VERSION INFORMATION

| Component | Current (in requirements.txt) | Latest Available | Action Required |
|-----------|-------------------------------|------------------|-----------------|
| pyesef | >=1.0 | 1.0.2 | **ARCHIVED** -- library abandoned 2026-01-03 |

---

# =====================================================================
# PART A: UNOFFICIAL COMMUNITY WRAPPER -- pyesef
# =====================================================================

## A1. Registry Data

**Source**: https://pypi.org/pypi/pyesef/json (fetched 2026-02-24)
```
name: pyesef
version: 1.0.2
summary: (empty)
requires_python: >=3.6
homepage: https://github.com/ggravlingen/pyesef
```

## A2. CRITICAL: Library is ARCHIVED

**Source**: https://github.com/ggravlingen/pyesef/blob/main/README.md (fetched 2026-02-24)
```
# COPIED VERBATIM -- first line of README
**ARCHIVED 2026-01-03**
```

pyesef was archived by its maintainer on January 3, 2026. No further updates will be made.
Our wrapper (`eu_esef_wrapper.py`) checks for pyesef availability but gracefully degrades
when not installed. Since the library is now archived, it should NOT be relied upon.

## A3. Verbatim Code (from README before archival)

**Source**: https://github.com/ggravlingen/pyesef/blob/main/README.md
```
# COPIED VERBATIM
A library for extracting XBRL-files in the ESEF-format using the Arelle module.

#### How to use
- Download sample archives: `python3 -m pyesef -d`.
- Files in the `archives` folder will be extracted if you run `python3 -m pyesef -e`.
  This will create two files: `definitions.csv` and `output.csv`.
```

## A4. Audit of Our Wrapper

Our `eu_esef_wrapper.py` imports pyesef but only for optional local XBRL file parsing.
The primary data path uses filings.xbrl.org API directly, so the archival of pyesef
does NOT break functionality. The wrapper correctly degrades:
```python
try:
    import pyesef
    self._pyesef_available = True
except ImportError:
    logger.info("pyesef not available; using filings.xbrl.org API only")
```

---

# =====================================================================
# PART B: GOVERNMENT API -- filings.xbrl.org
# =====================================================================

## B1. API Verification

**Source**: https://filings.xbrl.org/api/filings (fetched 2026-02-24, returns JSON)
```
# VERBATIM response structure (first entry abbreviated):
{
  "data": [
    {
      "type": "filing",
      "id": "9986",
      "attributes": {
        "country": "UA",
        "period_end": "2020-12-31",
        "date_added": "2023-11-09 18:26:01.957777",
        "processed": "2023-11-14 15:49:47.074643",
        "json_url": "/EDRPOU-32033791/2020-12-31/UAIFRS/UA/0/32033791-2020-12-31.json",
        "viewer_url": "/EDRPOU-32033791/2020-12-31/UAIFRS/UA/0/ixbrlviewer.html",
        "error_count": 0,
        "warning_count": 0
      },
      "relationships": {
        "entity": {"links": {"related": "/api/entities/32033791"}},
        "validation_messages": {"links": {"related": "/api/filings/9986/validation_messages"}}
      }
    }
  ],
  "meta": {"count": 23478},
  "jsonapi": {"version": "1.0"}
}
```

## B2. Verified Endpoints

| Endpoint | Status | Returns |
|----------|--------|---------|
| `GET /api/filings` | WORKING | JSON:API with filing metadata |
| `GET /api/filings?country=FR` | WORKING | Filtered by country code |
| `GET /api/filings/{id}` | EXPECTED | Single filing detail |
| `GET /api/entities/{id}` | EXPECTED | Entity metadata |
| `GET /api/filings/{id}/facts` | UNVERIFIED | XBRL facts for a filing |

**Note**: `/api/v1/filings` returns 404. The correct path is `/api/filings` (no v1).

## B3. Response Field Mapping

From the verbatim response above, our wrapper uses these fields:
- `entity.name` -- company name
- `entity.lei` -- LEI identifier
- `entity.country` -- ISO-2 country code
- `attributes.date_added` -- used as filing_date
- `attributes.period_end` -- used as report_date period end
- `attributes.json_url` -- path to XBRL JSON for fact extraction

## B4. Canonical Field Coverage (via _IFRS_MAP in canonical_translator.py)

The IFRS concept mappings are sourced from the codebase, not from the API:
- **Income**: ifrs-full:Revenue -> revenue, ifrs-full:CostOfSales -> cost_of_revenue, etc.
- **Balance**: ifrs-full:Assets -> total_assets, ifrs-full:Liabilities -> total_liabilities, etc.
- **Cashflow**: ifrs-full:CashFlowsFromUsedInOperatingActivities -> operating_cash_flow, etc.

---

# =====================================================================
# PART C: SUMMARY
# =====================================================================

| Mode | Component | Status |
|------|-----------|--------|
| Unofficial (optional) | pyesef 1.0.2 | **ARCHIVED 2026-01-03** -- graceful degradation OK |
| Government (primary) | filings.xbrl.org /api/filings | WORKING -- JSON:API format confirmed |

### Required Fixes
1. **MINOR**: Consider removing pyesef from requirements.txt since it's archived
2. **NONE critical** -- primary data path via filings.xbrl.org works

---


# =====================================================================
# PART D: OHLCV & MACRO COVERAGE (added 2026-02-24)
# =====================================================================

## D1. OHLCV Price Data

**Primary**: yfinance 1.2.0 (global, no API key, 21.7k stars)
**Research log**: `.roo/research/ohlcv-yfinance-2026-02-24.md`

```python
# VERBATIM from yfinance source -- fetch European Union OHLCV
import yfinance as yf
df = yf.download(
    "AIR.PA",     # European Union ticker with ".PA/.DE/.AS" suffix
    period="5y",
    auto_adjust=False,      # raw/unadjusted OHLCV (PIT-safe)
    progress=False,
)
# Returns: DataFrame(Open, High, Low, Close, Adj Close, Volume)
```

**Ticker suffix for European Union**: `.PA/.DE/.AS`
**Example**: `AIR.PA`
**Notes**: yfinance primary. Suffix varies by country.

## D2. Macro Economic Data

**Primary**: wbgapi 1.0.13 (World Bank, 200+ countries, no API key)
**Research log**: `.roo/research/macro-wbgapi-2026-02-24.md`

```python
# VERBATIM from wbgapi source -- fetch European Union macro indicators
import wbgapi as wb
df = wb.data.DataFrame(
    ["NY.GDP.MKTP.KD.ZG", "FP.CPI.TOTL.ZG", "SL.UEM.TOTL.ZS"],
    economy="EMU",    # European Union World Bank code
    mrv=10,                 # most recent 10 years
    numericTimeKeys=True,
)
# Returns: DataFrame with GDP growth, inflation, unemployment
```

**World Bank code for European Union**: `EMU`

**END OF RESEARCH LOG**
